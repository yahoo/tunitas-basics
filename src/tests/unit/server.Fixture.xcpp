// This is -*- c++ -*- in the S.C.O.L.D. stylings that are so popular these days.
#divert <fpp>
namespace tests::unit::server { class Fixture; }
#endiv
#divert <hpp>
#import cppunit.Test
#import cppunit.test.Fixture
class tests::unit::server::Fixture : public cppunit::test::Fixture {
public:
  auto test_exception_Example() -> void;
  static auto suite() -> cppunit::Test *;
protected:
  struct exception {
    class [[nodiscard]] Example;
  };
};
#endiv
#divert <cpp>
#import std.literals
using namespace std::literals;
#import tests.unit.server.Fixture.exception.Example
auto tests::unit::server::Fixture::test_exception_Example() -> void {
  try {
    // Show the MI scheme works by in the constructor
    throw exception::Example{"badness"};
  } catch (tunitas::server::exception::Generic const &g) {
    // Show that catching by one of the MI personas works
    std::string reason = g.what();
    CPPUNIT_ASSERT_EQUAL("badness"s, reason);
  }
}
#import unit.rigging.suite.Stream
#import unit.rigging.suite.call
#import unit.rigging.suite.add
auto tests::unit::server::Fixture::suite() -> cppunit::Test * {
  using namespace ::unit::rigging::suite;
  Stream series("server");
  {
    Stream exc("exception");
    exc << call("Example", &Fixture::test_exception_Example)
      ;
    series << add(exc.release());
  }
  return series.release();
}
#endiv
